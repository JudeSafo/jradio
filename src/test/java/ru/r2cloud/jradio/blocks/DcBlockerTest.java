package ru.r2cloud.jradio.blocks;

import org.junit.Test;

import ru.r2cloud.jradio.Context;
import ru.r2cloud.jradio.TestUtil;
import ru.r2cloud.jradio.source.InputStreamSource;

public class DcBlockerTest {

	@Test
	public void test() throws Exception {
		Context context = new Context();
		context.setChannels(1);
		float[] tail = new float[] { -7.314034E-4f, 0.0018730211f, 0.0011055265f, 0.0029656957f, -6.620772E-4f, 0.007863358f, -0.0065245633f, 0.0022669989f, -0.005417575f, -0.001321176f, 0.004389851f, -0.0080661345f, -0.009762441f, -0.005939852f, -0.0057403473f, -4.2771635E-4f, 0.002813029f,
				0.0012482586f, -0.0016237868f, 0.005628607f, 0.0045870636f, -0.003664565f, 6.150219E-4f, 3.4803856E-4f, -0.0039011668f, -3.940506E-4f, -0.0045435885f, 0.0017562418f, -0.013760082f, 0.0063334256f, 0.0020115736f, -0.0036608095f, 0.008292696f, -0.002152349f, -0.0035591947f,
				0.013157009f, 0.0024025452f, -0.004748067f, -3.6005804E-4f, 0.0029387672f, 0.0056357607f, -0.007947327f, -5.828366E-4f, 0.0072145006f, 0.009954048f, 0.015973695f, -0.009861439f, -0.0015522726f, -0.0069198464f, 9.2176313E-4f, -6.8737485E-4f, -0.0071387934f, 0.004025015f, -0.00909499f,
				0.0024585666f, -0.005719186f, -0.0017914264f, 0.005699443f, 0.006492043f, 0.009229077f, 0.0013940373f, -0.0017543936f, -5.40007E-4f, -5.2499963E-4f, -5.09009E-4f, -4.922031E-4f, -4.7471677E-4f, -4.5669376E-4f, -4.3829126E-4f, -4.1961775E-4f, -4.0077043E-4f, -3.818705E-4f,
				-3.630325E-4f, -3.4436016E-4f, -3.2592844E-4f, -3.0783936E-4f, -2.9019912E-4f, -2.730765E-4f, -2.5649063E-4f, -2.403917E-4f, -2.247596E-4f, -2.0957728E-4f, -1.9485428E-4f, -1.8059532E-4f, -1.6680371E-4f, -1.5351284E-4f, -1.4074263E-4f, -1.2854174E-4f, -1.1694759E-4f, -1.0601735E-4f,
				-9.580896E-5f, -8.63559E-5f, -7.766034E-5f, -6.9688715E-5f, -6.238692E-5f, -5.5711556E-5f, -4.962127E-5f, -4.407137E-5f, -3.9025253E-5f, -3.4444492E-5f, -3.028752E-5f, -2.6525593E-5f, -2.3132583E-5f, -2.0078176E-5f, -1.7332088E-5f, -1.4867237E-5f, -1.2662344E-5f, -1.0688999E-5f,
				-8.918711E-6f, -7.330356E-6f, -5.9128156E-6f, -4.670729E-6f, -3.5998687E-6f, -2.695077E-6f, -1.9451559E-6f, -1.3403535E-6f, -8.708349E-7f, -5.205343E-7f, -2.778034E-7f, -1.2290062E-7f, -3.9008327E-8f, -4.4315662E-9f, 3.6602525E-9f, 2.0951954E-9f };
		try (DcBlocker source = new DcBlocker(new InputStreamSource(DcBlockerTest.class.getClassLoader().getResourceAsStream("lmsdd.bin"), context), 32, true)) {
			TestUtil.assertFloatInput("dcBlocker.bin", source);
			TestUtil.assertTail(tail, source);
		}
	}

}
